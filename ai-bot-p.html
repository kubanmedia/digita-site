<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digita AI Chatbot</title>\n    <meta name="description" content="Professional AI-powered digital marketing services including SEO, social media marketing, and chatbot solutions. Digita AI Chatbot">
    <link href="css/tailwind-alternative.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        secondary: '#8b5cf6',
                        dark: '#0f172a',
                        light: '#f8fafb',
                        accent: '#10b981'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Space Mono', 'monospace']
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 5s infinite',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #f8fafc;
            overflow-x: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .gradient-text {
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
        }

        .card-glass {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .input-glass {
            background: rgba(15, 23, 42, 0.5);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        /* Custom scrollbar for chat messages */
        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }
        .chat-messages::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.3);
            border-radius: 10px;
        }
        .chat-messages::-webkit-scrollbar-thumb {
            background: #6366f1;
            border-radius: 10px;
        }
        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: #8b5cf6;
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="card-glass rounded-3xl p-6 border border-gray-800/50 relative overflow-hidden w-full max-w-2xl">
        <div class="absolute -top-20 -right-20 w-64 h-64 rounded-full bg-primary/10 blur-2xl"></div>
        <div class="flex items-center mb-6">
            <div class="w-10 h-10 rounded-full gradient-bg flex items-center justify-center">
                <i class="fas fa-robot text-white"></i>
            </div>
            <div class="ml-3">
                <h3 class="font-bold text-white">Digita AI Chatbot</h3>
                <p class="text-xs text-gray-400">Online</p>
            </div>
        </div>

        <div id="chat-messages" class="space-y-4 h-96 overflow-y-auto pr-2 mb-6 chat-messages">
        </div>

        <div class="mt-6 flex items-center">
            <input type="text" id="user-input" placeholder="Type your message..." class="input-glass flex-1 rounded-full px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-primary" onkeydown="if(event.keyCode === 13) sendMessage()">
            <button onclick="sendMessage()" class="ml-2 w-10 h-10 rounded-full gradient-bg flex items-center justify-center">
                <i class="fas fa-paper-plane text-white"></i>
            </button>
        </div>
    </div>

    <script>
        [span_0](start_span)const chatMessages = document.getElementById('chat-messages');[span_0](end_span)
        [span_1](start_span)const userInput = document.getElementById('user-input');[span_1](end_span)
        let digitaConfig = {}; // Will be populated after fetching from backend

        // Function to display messages in the chat interface
        function displayMessage(sender, message, isUser = false) {
            [span_2](start_span)const messageDiv = document.createElement('div');[span_2](end_span)
            if (isUser) {
                [span_3](start_span)messageDiv.className = 'flex justify-end';[span_3](end_span)
                messageDiv.innerHTML = `
                    <div class="bg-primary/20 rounded-2xl p-4 max-w-xs">
                        <p class="text-sm">${message}</p>
                    </div>
                `;
            } else {
                [span_4](start_span)messageDiv.className = 'bg-gray-800/50 rounded-2xl p-4 max-w-xs';[span_4](end_span)
                messageDiv.innerHTML = `<p class="text-sm">${message}</p>`;
            }
            chatMessages.appendChild(messageDiv);
            [span_5](start_span)chatMessages.scrollTop = chatMessages.scrollHeight;[span_5](end_span) // Scroll to bottom
        }

        // Fetch configuration from PHP backend
        async function fetchConfig() {
            try {
                const response = await fetch('config.php');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                digitaConfig = await response.json();
                console.log('Configuration loaded:', digitaConfig);
                [span_6](start_span)displayMessage('bot', "Hello! I'm Digita, your AI marketing assistant. How can I help grow your business today?");[span_6](end_span)
            } catch (error) {
                console.error('Error fetching configuration:', error);
                displayMessage('bot', 'Error: Could not load configuration. Please check the server setup.');
            }
        }

        // Add initial chatbot greeting after configuration is loaded
        document.addEventListener('DOMContentLoaded', fetchConfig);

        async function sendMessage() {
            [span_7](start_span)const message = userInput.value.trim();[span_7](end_span)
            if (message === '') return;

            [span_8](start_span)displayMessage('user', message, true);[span_8](end_span) // Display user message
            [span_9](start_span)userInput.value = '';[span_9](end_span) // Clear input

            // Display typing indicator
            [span_10](start_span)const typingIndicatorDiv = document.createElement('div');[span_10](end_span)
            [span_11](start_span)typingIndicatorDiv.id = 'typing-indicator';[span_11](end_span)
            typingIndicatorDiv.className = 'bg-gray-800/50 rounded-2xl p-4 max-w-xs';
            typingIndicatorDiv.innerHTML = `
                <div class="flex space-x-2">
                    <div class="w-3 h-3 rounded-full bg-gray-600 animate-pulse"></div>
                    <div class="w-3 h-3 rounded-full bg-gray-600 animate-pulse delay-75"></div>
                    <div class="w-3 h-3 rounded-full bg-gray-600 animate-pulse delay-150"></div>
                </div>
            `;
            [span_12](start_span)chatMessages.appendChild(typingIndicatorDiv);[span_12](end_span)
            [span_13](start_span)chatMessages.scrollTop = chatMessages.scrollHeight;[span_13](end_span)

            try {
                if (!digitaConfig.apiKey) {
                    throw new Error("API Key is not loaded. Cannot send message.");
                }

                const messagesToSend = [
                    [span_14](start_span){ role: 'system', content: digitaConfig.systemPrompt },[span_14](end_span)
                    { role: 'user', content: message }
                ];
                [span_15](start_span)const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {[span_15](end_span)
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        [span_16](start_span)'Authorization': `Bearer ${digitaConfig.apiKey}`[span_16](end_span)
                    },
                    body: JSON.stringify({
                        [span_17](start_span)model: digitaConfig.model,[span_17](end_span)
                        messages: messagesToSend,
                        [span_18](start_span)temperature: digitaConfig.temperature,[span_18](end_span)
                        max_tokens: 500
                    })
                });
                [span_19](start_span)if (!response.ok) {[span_19](end_span)
                    [span_20](start_span)const errorData = await response.json();[span_20](end_span)
                    [span_21](start_span)throw new Error(`Groq API error: ${response.status} - ${errorData.message || response.statusText}`);[span_21](end_span)
                }

                [span_22](start_span)const data = await response.json();[span_22](end_span)
                [span_23](start_span)const aiMessage = data.choices[0].message.content;[span_23](end_span)

                // Remove typing indicator
                [span_24](start_span)chatMessages.removeChild(typingIndicatorDiv);[span_24](end_span)
                [span_25](start_span)displayMessage('bot', aiMessage);[span_25](end_span) // Display AI response

            } catch (error) {
                [span_26](start_span)console.error('Error communicating with Groq API:', error);[span_26](end_span)
                // Remove typing indicator if it's still there
                [span_27](start_span)if (document.getElementById('typing-indicator')) {[span_27](end_span)
                    [span_28](start_span)chatMessages.removeChild(typingIndicatorDiv);[span_28](end_span)
                }
                [span_29](start_span)displayMessage('bot', `Error: Could not get a response. Please try again later. (Details: ${error.message})`);[span_29](end_span)
            } finally {
                [span_30](start_span)chatMessages.scrollTop = chatMessages.scrollHeight;[span_30](end_span) // Scroll to bottom after response or error
            }
        }
    </script>
</body>
</html>
